/*!
 *  Kwicks: Sexy Sliding Panels for jQuery - v2.2.1
 *  http://devsmash.com/projects/kwicks
 *
 *  Copyright 2013 Jeremy Martin (jmar777)
 *  Contributors: Duke Speer (Duke3D), Guillermo Guerrero (gguerrero)
 *  Released under the MIT license
 *  http://www.opensource.org/licenses/mit-license.php
 */
(function(e){var t={init:function(t){var r={maxSize:-1,minSize:-1,spacing:5,duration:500,isVertical:false,easing:undefined,autoResize:true,behavior:null,delayMouseIn:0,delayMouseOut:0,selectOnClick:true,deselectOnClick:false,interval:2500,interactive:true,interaction:"hover"};var i=e.extend(r,t);if(i.minSize!==-1&&i.maxSize!==-1)throw new Error("Kwicks options minSize and maxSize may not both be set");if(i.behavior&&i.behavior!=="menu"&&i.behavior!=="slideshow")throw new Error("Unrecognized Kwicks behavior specified: "+i.behavior);e.each(["minSize","maxSize","spacing"],function(e,t){var n=i[t];switch(typeof n){case"number":i[t+"Units"]="px";break;case"string":if(n.slice(-1)==="%"){i[t+"Units"]="%";i[t]=+n.slice(0,-1)/100}else if(n.slice(-2)==="px"){i[t+"Units"]="px";i[t]=+n.slice(0,-2)}else{throw new Error("Invalid value for Kwicks option "+t+": "+n)}break;default:throw new Error("Invalid value for Kwicks option "+t+": "+n)}});return this.each(function(){e(this).data("kwicks",new n(this,i))})},expand:function(t,n){if(typeof t==="object"){n=t;t=undefined}var r=n&&n.delay||0;return this.each(function(){var n=e(this),i=n.data("kwicks");if(i){t=typeof t==="number"?t:-1}else if(i=n.parent().data("kwicks")){t=n.index()}else{return}var s=function(){if(t===i.expandedIndex)return;var e=i.$panels,n=e[t]||null;i.$container.trigger("expand.kwicks",{index:t,expanded:n,collapsed:e.not(n).get(),oldIndex:i.expandedIndex,oldExpanded:i.getExpandedPanel(),isAnimated:i.isAnimated})};var o=i.$container.data("kwicks-timeout-id");if(o){i.$container.removeData("kwicks-timeout-id");clearTimeout(o)}if(r>0){i.$container.data("kwicks-timeout-id",setTimeout(s,r))}else{s()}})},expanded:function(){var e=this.first().data("kwicks");if(!e)return;return e.expandedIndex},select:function(t){return this.each(function(){var n=e(this),r=n.data("kwicks");if(r){t=typeof t==="number"?t:-1}else if(r=n.parent().data("kwicks")){t=n.index()}else{return}if(t!==r.selectedIndex){var i=r.$panels,s=i[t]||null;r.$container.trigger("select.kwicks",{index:t,selected:s,unselected:i.not(s).get(),oldIndex:r.selectedIndex,oldSelected:r.getSelectedPanel()})}r.$container.kwicks("expand",t)})},selected:function(){var e=this.first().data("kwicks");if(!e)return;return e.selectedIndex},resize:function(){return this.each(function(){var t=e(this),n=t.data("kwicks");if(!n)return;n.resize()})},destroy:function(){return this.each(function(){var t=e(this),n=t.data("kwicks");if(!n)return;n.destroy()})}};e.fn.kwicks=function(e){if(t[e]){return t[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return t.init.apply(this,arguments)}else{throw new Error("Unrecognized kwicks method: "+e)}};e.event.special.expand={_default:function(t,n){if(t.namespace!=="kwicks")return;var r=e(t.target).data("kwicks");if(r)r.expand(n.index)}};e.event.special.select={_default:function(t,n){if(t.namespace!=="kwicks")return;var r=e(t.target).data("kwicks");if(r)r.select(n.index)}};var n=function(n,r){var i=this;this.opts=r;this.onDestroyHandlers=[];var s=r.isVertical?"vertical":"horizontal";this.$container=e(n);this.$panels=this.$container.children();var o=["kwicks","kwicks-"+s];e.each(o,function(e){if(i.$container.hasClass(e))return;i.$container.addClass(e);i.onDestroy(function(){i.$container.removeClass(e)})});this.selectedIndex=this.$panels.filter(".kwicks-selected").index();this.expandedIndex=this.selectedIndex;this.primaryDimension=r.isVertical?"height":"width";this.secondaryDimension=r.isVertical?"width":"height";this.calculatePanelSizes();this.primaryAlignment=r.isVertical?"top":"left";this.secondaryAlignment=r.isVertical?"bottom":"right";this.$timer=e({progress:0});this.isAnimated=false;this.offsets=this.getOffsetsForExpanded();this.updatePanelStyles();this.initBehavior();this.initWindowResizeHandler();setTimeout(function(){i.updatePanelStyles()},100)};n.prototype.calculatePanelSizes=function(){var e=this.opts,t=this.getContainerSize(true);if(e.spacingUnits==="%"){this.panelSpacing=t*e.spacing}else{this.panelSpacing=e.spacing}var n=this.$panels.length,r=this.panelSpacing*(n-1),i=t-r;this.panelSize=i/n;if(e.minSize===-1){if(e.maxSize===-1){if(n<5){this.panelMaxSize=t/3*2}else{this.panelMaxSize=t/3}}else if(e.maxSizeUnits==="%"){this.panelMaxSize=i*e.maxSize}else{this.panelMaxSize=e.maxSize}this.panelMinSize=(i-this.panelMaxSize)/(n-1)}else if(e.maxSize===-1){if(e.minSizeUnits==="%"){this.panelMinSize=i*e.minSize}else{this.panelMinSize=e.minSize}this.panelMaxSize=i-this.panelMinSize*(n-1)}};n.prototype.getOffsetsForExpanded=function(){var e=this.expandedIndex,t=this.$panels.length,n=this.panelSpacing,r=this.panelSize,i=this.panelMinSize,s=this.panelMaxSize;var o=[0];for(var u=1;u<t;u++){if(e===-1){o[u]=u*(r+n)}else if(u<=e){o[u]=u*(i+n)}else{o[u]=s+i*(u-1)+u*n}}return o};n.prototype.setStyle=function(){if(e.support.style){return function(e,t){e.setAttribute("style",t)}}else{return function(e,t){e.style.cssText=t}}}();n.prototype.updatePanelStyles=function(){var e=this.offsets,t=this.$panels,n=this.primaryDimension,r=this.primaryAlignment,i=this.secondaryAlignment,s=this.panelSpacing,o=this.getContainerSize();var u=!!this._stylesInited?"":"position:absolute;",a,f,l,c;for(var h=t.length;h--;){l=a;a=Math.round(e[h]);if(h===t.length-1){f=o-a;c=i+":0;"+n+":"+f+"px;"}else{f=l-a-s;c=r+":"+a+"px;"+n+":"+f+"px;"}this.setStyle(t[h],u+c)}if(!this._stylesInited){this.$container.addClass("kwicks-processed");this._stylesInited=true}};n.prototype.initBehavior=function(){if(!this.opts.behavior)return;switch(this.opts.behavior){case"menu":this.initMenuBehavior();break;case"slideshow":this.initSlideshowBehavior();break;default:throw new Error("Unrecognized behavior option: "+this.opts.behavior)}};n.prototype.initMenuBehavior=function(){var t=this,n=t.opts;if(n.interaction=="hover"){this.addEventHandler(this.$container,"mouseleave",function(){t.$container.kwicks("expand",-1,{delay:n.delayMouseOut})});this.addEventHandler(this.$panels,"mouseenter",function(){e(this).kwicks("expand",{delay:n.delayMouseIn})});if(!n.selectOnClick&&!n.deselectOnClick)return;this.addEventHandler(this.$panels,"click",function(){var t=e(this),r=t.hasClass("kwicks-selected");if(r&&n.deselectOnClick){t.parent().kwicks("select",-1)}else if(!r&&n.selectOnClick){t.kwicks("select")}})}else if(n.interaction=="click"){this.addEventHandler(this.$container,"click",function(){t.$container.kwicks("expand",-1,{delay:n.delayMouseOut})});this.addEventHandler(this.$panels,"click",function(){e(this).kwicks("expand",{delay:n.delayMouseIn})});if(!n.selectOnClick&&!n.deselectOnClick)return;this.addEventHandler(this.$panels,"click",function(){var t=e(this),r=t.hasClass("kwicks-selected");if(r&&n.deselectOnClick){t.parent().kwicks("select",-1)}else if(!r&&n.selectOnClick){t.kwicks("select")}})}};n.prototype.initSlideshowBehavior=function(){var t=this,n=this.$panels.length,r=0,i=false,s;var o=function(){if(i)return;s=setInterval(function(){t.$container.kwicks("expand",++r%n)},t.opts.interval);i=true};var u=function(){clearInterval(s);i=false};o();this.onDestroy(u);if(!this.opts.interactive)return;this.addEventHandler(this.$container,"mouseenter",u);this.addEventHandler(this.$container,"mouseleave",o);this.addEventHandler(this.$panels,"mouseenter",function(){r=e(this).kwicks("expand").index()})};n.prototype.initWindowResizeHandler=function(){if(!this.opts.autoResize)return;var t=this,n=0,r=false,i=e(window);var s=function(e){if(!e){r=false}var i=+(new Date);if(i-n<20){if(r)return;setTimeout(s,20-(i-n));r=true;return}n=i;t.resize()};this.addEventHandler(i,"resize",s)};n.prototype.getContainerSize=function(e){var t=this._containerSize;if(e||!t){t=this._containerSize=this.$container[this.primaryDimension]()}return t};n.prototype.getExpandedPanel=function(){return this.$panels[this.expandedIndex]||null};n.prototype.getCollapsedPanels=function(){if(this.expandedIndex===-1)return[];return this.$panels.not(this.getExpandedPanel()).get()};n.prototype.getSelectedPanel=function(){return this.$panels[this.selectedIndex]||null};n.prototype.getUnselectedPanels=function(){return this.$panels.not(this.getSelectedPanel()).get()};n.prototype.onDestroy=function(e){this.onDestroyHandlers.push(e)};n.prototype.addEventHandler=function(e,t,n){e.on(t,n);this.onDestroy(function(){e.off(t,n)})};n.prototype.destroy=function(){this.$timer.stop();for(var e=0,t=this.onDestroyHandlers.length;e<t;e++){this.onDestroyHandlers[e]()}this.$panels.attr("style","").removeClass("kwicks-expanded kwicks-selected kwicks-collapsed");this.$container.removeClass("kwicks-processed").removeData("kwicks")};n.prototype.resize=function(){if(this.getContainerSize()===this.getContainerSize(true))return;this.calculatePanelSizes();this.offsets=this.getOffsetsForExpanded();if(this.isAnimated){this._dirtyOffsets=true}else{this.updatePanelStyles()}};n.prototype.select=function(t){if(t===this.selectedIndex)return;e(this.getSelectedPanel()).removeClass("kwicks-selected");this.selectedIndex=t;e(this.getSelectedPanel()).addClass("kwicks-selected")};n.prototype.expand=function(t){var n=this,r=this.expandedIndex,i=this.getExpandedPanel();if(t===-1)t=this.selectedIndex;if(t===this.expandedIndex)return;e(this.getExpandedPanel()).removeClass("kwicks-expanded");e(this.getCollapsedPanels()).removeClass("kwicks-collapsed");this.expandedIndex=t;e(this.getExpandedPanel()).addClass("kwicks-expanded");e(this.getCollapsedPanels()).addClass("kwicks-collapsed");var s=this.$timer,o=this.$panels.length,u=this.offsets.slice(),a=this.offsets,f=this.getOffsetsForExpanded();s.stop()[0].progress=0;this.isAnimated=true;s.animate({progress:1},{duration:this.opts.duration,easing:this.opts.easing,step:function(e){if(n._dirtyOffsets){a=n.offsets;f=n.getOffsetsForExpanded();n._dirtyOffsets=false}a.length=0;for(var t=0;t<o;t++){var r=f[t],i=r-(r-u[t])*(1-e);a[t]=i}n.updatePanelStyles()},complete:function(){n.isAnimated=false;n.$container.trigger("expand-complete.kwicks",{index:t,expanded:n.getExpandedPanel(),collapsed:n.getCollapsedPanels(),oldIndex:r,oldExpanded:i,isAnimated:false})}})}})(jQuery)